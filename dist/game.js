!function t(e,r,n){function o(a,u){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return o(r?r:t)},l,l.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){u.label=r[1];break}if(6===r[0]&&u.label<a[1]){u.label=a[1],a=r;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(r);break}a[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}};Object.defineProperty(r,"__esModule",{value:!0});var i,a=t("./utils");!function(t){t[t.EMPTY=0]="EMPTY",t[t.PLAYER_1=1]="PLAYER_1",t[t.PLAYER_2=2]="PLAYER_2",t[t.DRAW=3]="DRAW"}(i=r.BoardPiece||(r.BoardPiece={}));var u=function(){function t(t){this.row=6,this.column=7,this.map=[];for(var e=0;e<this.row;e++){this.map.push([]);for(var r=0;r<this.column;r++)this.map[e].push(i.EMPTY)}this.canvas=t,this.context=t.getContext("2d")}return t.prototype.applyPlayerAction=function(t,e){return n(this,void 0,void 0,function(){var r,n,a;return o(this,function(o){switch(o.label){case 0:if(this.map[0][e]!==i.EMPTY||e<0||e>=this.column)return[2,!1];for(r=!1,n=0,a=0;a<this.row-1;a++)if(this.map[a+1][e]!==i.EMPTY){r=!0,n=a;break}return r||(n=this.row-1),[4,this.animateAction(n,e,t.boardPiece)];case 1:return o.sent(),this.map[n][e]=t.boardPiece,this.debug(),[2,!0]}})})},t.prototype.debug=function(){console.log(this.map.map(function(t){return t.join(" ")}).join("\n"))},t.prototype.getWinner=function(){for(var t=this,e=[[0,-1],[0,1],[-1,-1],[-1,0],[-1,1],[1,-1],[1,0],[1,1]],r=function(e,n,o,i,a){return a>=4||!(e<0||n<0||e>=t.row||n>=t.column||t.map[e][n]!==o)&&r(e+i[0],n+i[1],o,i,a+1)},n=0;n<this.row;n++)for(var o=0;o<this.column;o++){var a=this.map[n][o];if(a!==i.EMPTY)for(var u=0;u<e.length;u++){var c=r(n+e[u][0],o+e[u][1],a,e[u],1);if(c)return a}}return i.EMPTY},t.prototype.getPlayerColor=function(t){switch(t){case i.PLAYER_1:return"#ff4136";case i.PLAYER_2:return"#0074d9";default:return"transparent"}},t.prototype.animateAction=function(t,e,r){return n(this,void 0,void 0,function(){var n,i,u,c=this;return o(this,function(o){return n=this.getPlayerColor(r),i=0,u=function(){a.Utils.clearCanvas(c),a.Utils.drawCircle(c.context,{x:75*e+100,y:i+50,r:25,fill:n,stroke:"black"}),c.render(),i+=25,75*t>=i&&window.requestAnimationFrame(u)},[2]})})},t.prototype.render=function(){a.Utils.drawMask(this);var t,e;for(e=0;e<this.row;e++)for(t=0;t<this.column;t++)a.Utils.drawCircle(this.context,{x:75*t+100,y:75*e+50,r:25,fill:this.getPlayerColor(this.map[e][t]),stroke:"black"});console.log("render")},t}();r.Board=u},{"./utils":6}],2:[function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){u.label=r[1];break}if(6===r[0]&&u.label<a[1]){u.label=a[1],a=r;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(r);break}a[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}};Object.defineProperty(r,"__esModule",{value:!0});var i=t("./board"),a=t("./player-human"),u=t("./player-ai"),c=function(){function t(){this.board=new i.Board(document.querySelector("canvas")),this.players=[new a.PlayerHuman(i.BoardPiece.PLAYER_1),new u.PlayerAi(i.BoardPiece.PLAYER_2)],this.currentPlayerId=0,this.isMoveAllowed=!1,this.isGameWon=!1,this.board.render(),this.board.debug()}return t.prototype.start=function(){return n(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:this.isMoveAllowed=!0,e.label=1;case 1:return this.isGameWon?[3,3]:[4,this.move()];case 2:return e.sent(),t=this.board.getWinner(),t!==i.BoardPiece.EMPTY&&(this.isGameWon=!0),[3,1];case 3:return[2]}})})},t.prototype.move=function(){return n(this,void 0,void 0,function(){var t,e,r;return o(this,function(n){switch(n.label){case 0:if(!this.isMoveAllowed)return[2];t=this.players[this.currentPlayerId],e=!1,n.label=1;case 1:return e?[3,4]:[4,t.getAction(this.board)];case 2:return r=n.sent(),this.isMoveAllowed=!1,[4,this.board.applyPlayerAction(t,r)];case 3:return e=n.sent(),this.isMoveAllowed=!0,[3,1];case 4:return this.currentPlayerId=this.getNextPlayer(),[2]}})})},t.prototype.getNextPlayer=function(){return 0===this.currentPlayerId?1:0},t}();r.Game=c;var s=new c;s.start()},{"./board":1,"./player-ai":3,"./player-human":4}],3:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){u.label=r[1];break}if(6===r[0]&&u.label<a[1]){u.label=a[1],a=r;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(r);break}a[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}};Object.defineProperty(r,"__esModule",{value:!0});var a=t("./player"),u=t("./utils"),c=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getAction=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,u.Utils.getRandomColumnNumber(t)]})})},e}(a.Player);r.PlayerAi=c},{"./player":5,"./utils":6}],4:[function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){u.label=r[1];break}if(6===r[0]&&u.label<a[1]){u.label=a[1],a=r;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(r);break}a[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}};Object.defineProperty(r,"__esModule",{value:!0});var a=t("./player"),u=t("./utils"),c=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getAction=function(t){return o(this,void 0,void 0,function(){return i(this,function(e){return[2,u.Utils.getRandomColumnNumber(t)]})})},e}(a.Player);r.PlayerHuman=c},{"./player":5,"./utils":6}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(t){this.boardPiece=t}return t}();r.Player=n},{}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function t(){}return t.drawCircle=function(t,e){var r=e.x,n=void 0===r?0:r,o=e.y,i=void 0===o?0:o,a=e.r,u=void 0===a?0:a,c=e.fill,s=void 0===c?"":c,l=e.stroke,f=void 0===l?"":l;t.save(),t.fillStyle=s,t.strokeStyle=f,t.beginPath(),t.arc(n,i,u,0,2*Math.PI,!1),t.fill(),t.restore()},t.drawMask=function(t){var e=t.context;e.save(),e.fillStyle="#ddd",e.beginPath();var r,n;for(n=0;n<t.row;n++)for(r=0;r<t.column;r++)e.arc(75*r+100,75*n+50,25,0,2*Math.PI),e.rect(75*r+150,75*n,-100,100);e.fill(),e.restore()},t.clearCanvas=function(t){t.context.clearRect(0,0,t.canvas.width,t.canvas.height)},t.isCoordOnColumn=function(t,e,r){return(t.x-e)*(t.x-e)<=r*r},t.getRandomColumnNumber=function(t){return Math.floor(Math.random()*t.column)},t}();r.Utils=n},{}]},{},[2]);
//# sourceMappingURL=game.js.map
